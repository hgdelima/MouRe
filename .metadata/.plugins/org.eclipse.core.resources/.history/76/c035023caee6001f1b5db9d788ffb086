<?PHP
	session_start();
	require_once "os.php";
	if(isset($_GET['kill']))
		unset($_SESSION['os']);
	if(!isset($_SESSION['os'])){
		$_SESSION['os']=array();
	}
	$os=new os(&$_SESSION['os']);
	if(isset($_POST['message']))
		$os->message($_POST['this'],$_POST['message'],$_POST);
	else
		$os->show();
?>
<script language="Javascript">
function sndmsg(bizname) {
    var xmlHttpReq = false;
    // Mozilla/Safari
    if (window.XMLHttpRequest) {xmlHttpReq = new XMLHttpRequest();}
    // IE
    else if (window.ActiveXObject) {xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");}
    xmlHttpReq.open('POST', "index.php", true);
    xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xmlHttpReq.onreadystatechange = function() {
        if (xmlHttpReq.readyState == 4 && xmlHttpReq.status==200) {
            document.getElementById(bizname).innerHTML = xmlHttpReq.responseText;
        }
    }
    xmlHttpReq.send(getquerystring(bizname));
}

function getquerystring(bizname) {
    var form = document.forms[bizname];
    var size = form.elements.length;
    var qstr ="";
	for(var i=0;i<size;i=i+1)
		qstr = qstr+form.elements[i].name+"="+escape(form.elements[i].value)+"&";
    return qstr;
}
</script>